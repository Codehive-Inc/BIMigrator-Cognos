{
  "source_name": "Custom SQL Query2",
  "name": "Custom SQL Query2",
  "lineage_tag": null,
  "description": "Table from federated relation: Custom SQL Query2",
  "is_hidden": false,
  "columns": [
    {
      "source_name": "weekday",
      "datatype": "int64",
      "format_string": null,
      "lineage_tag": null,
      "source_column": "ISOWEEKDAY('Custom SQL Query2'[FISCAL_DATE])",
      "description": "Converted from Tableau calculation: ISOWEEKDAY([FISCAL_DATE])",
      "is_hidden": false,
      "summarize_by": "sum",
      "data_category": null,
      "is_calculated": true,
      "is_data_type_inferred": true,
      "annotations": {
        "SummarizationSetBy": "User",
        "PBI_FormatHint": {
          "isGeneralNumber": true
        }
      }
    },
    {
      "source_name": "max Week Flag",
      "datatype": "boolean",
      "format_string": null,
      "lineage_tag": null,
      "source_column": "[Weekly count] = [Weekly count]",
      "description": "Converted from Tableau calculation: [Calculation_1420604241837174785]=[Weekly count (copy)_1420604241838956546]",
      "is_hidden": false,
      "summarize_by": "none",
      "data_category": null,
      "is_calculated": true,
      "is_data_type_inferred": true,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "Week Start Date",
      "datatype": "dateTime",
      "format_string": null,
      "lineage_tag": null,
      "source_column": "VAR MinDate = MINX(FILTER('Custom SQL Query2', 'Custom SQL Query2'[FISCAL_WEEK] = MAX('Custom SQL Query2'[FISCAL_WEEK])), 'Custom SQL Query2'[FISCAL_DATE]) RETURN MinDate",
      "description": "Converted from Tableau calculation: { FIXED [FISCAL_WEEK]:MIN([FISCAL_DATE])}",
      "is_hidden": false,
      "summarize_by": "none",
      "data_category": null,
      "is_calculated": true,
      "is_data_type_inferred": true,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "diff flag",
      "datatype": "string",
      "format_string": null,
      "lineage_tag": null,
      "source_column": "SWITCH(TRUE(), ['Custom SQL Query2'[% diff]] = 0, \"Gold\", ['Custom SQL Query2'[% diff]] > ('Parameters'[Parameter 1] / 100), \"Flag\", ['Custom SQL Query2'[% diff]] < ('Parameters'[Parameter 1] / 100), \"Normal\")",
      "description": "Converted from Tableau calculation: if [Calculation_1420604241840762884]=0 THEN 'Gold'\r\nELSEIF ([Calculation_1420604241840762884])>([Parameters].[Parameter 1]/100) THEN 'Flag'\r\nELSEIF  ([Calculation_1420604241840762884])<([Parameters].[Parameter 1]/100) THEN 'Normal' END",
      "is_hidden": false,
      "summarize_by": "none",
      "data_category": null,
      "is_calculated": true,
      "is_data_type_inferred": true,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "help",
      "datatype": "string",
      "format_string": null,
      "lineage_tag": null,
      "source_column": "\"Help\"",
      "description": "Converted from Tableau calculation: 'Help'",
      "is_hidden": false,
      "summarize_by": "none",
      "data_category": null,
      "is_calculated": true,
      "is_data_type_inferred": true,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "Golden Date",
      "datatype": "dateTime",
      "format_string": null,
      "lineage_tag": null,
      "source_column": "IF 'Custom SQL Query2'[max Week Flag] THEN 'Custom SQL Query2'[FISCAL_DATE] END",
      "description": "Converted from Tableau calculation: IF [Calculation_1420604241839083523]=TRUE then [FISCAL_DATE] END",
      "is_hidden": false,
      "summarize_by": "none",
      "data_category": null,
      "is_calculated": true,
      "is_data_type_inferred": true,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "Subject",
      "datatype": "string",
      "format_string": null,
      "lineage_tag": null,
      "source_column": "\"Data Load below \" & CONCATENATE(CONCATENATE(MIN('Custom SQL Query2'[Parameters]), \".'), '[Parameter 1]\") & \"% Of Golden Data Range\"",
      "description": "Converted from Tableau calculation: \"Data Load below \"+STR([Parameters].[Parameter 1])+\"% Of Golden Data Range\"",
      "is_hidden": false,
      "summarize_by": "none",
      "data_category": null,
      "is_calculated": true,
      "is_data_type_inferred": true,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "Avg Range",
      "datatype": "int64",
      "format_string": null,
      "lineage_tag": null,
      "source_column": "INT('Custom SQL Query2'[AVG_DATA])",
      "description": "Converted from Tableau calculation: INT([AVG_DATA])",
      "is_hidden": false,
      "summarize_by": "sum",
      "data_category": null,
      "is_calculated": true,
      "is_data_type_inferred": true,
      "annotations": {
        "SummarizationSetBy": "User",
        "PBI_FormatHint": {
          "isGeneralNumber": true
        }
      }
    },
    {
      "source_name": "Week End Date",
      "datatype": "dateTime",
      "format_string": null,
      "lineage_tag": null,
      "source_column": "CALCULATE(MAX('Custom SQL Query2'[FISCAL_DATE]), ALLEXCEPT('Custom SQL Query2', 'Custom SQL Query2'[FISCAL_WEEK]))",
      "description": "Converted from Tableau calculation: { FIXED [FISCAL_WEEK]:MAX([FISCAL_DATE])}",
      "is_hidden": false,
      "summarize_by": "none",
      "data_category": null,
      "is_calculated": true,
      "is_data_type_inferred": true,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "Tab_module",
      "datatype": "string",
      "format_string": null,
      "lineage_tag": null,
      "source_column": "Tab_module",
      "description": null,
      "is_hidden": false,
      "summarize_by": "none",
      "data_category": null,
      "is_calculated": false,
      "is_data_type_inferred": false,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "asup_date",
      "datatype": "string",
      "format_string": null,
      "lineage_tag": null,
      "source_column": "asup_date",
      "description": null,
      "is_hidden": false,
      "summarize_by": "none",
      "data_category": null,
      "is_calculated": false,
      "is_data_type_inferred": false,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "dt",
      "datatype": "string",
      "format_string": null,
      "lineage_tag": null,
      "source_column": "dt",
      "description": null,
      "is_hidden": false,
      "summarize_by": "none",
      "data_category": null,
      "is_calculated": false,
      "is_data_type_inferred": false,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "serial_count",
      "datatype": "int64",
      "format_string": null,
      "lineage_tag": null,
      "source_column": "serial_count",
      "description": null,
      "is_hidden": false,
      "summarize_by": "sum",
      "data_category": null,
      "is_calculated": false,
      "is_data_type_inferred": false,
      "annotations": {
        "SummarizationSetBy": "User",
        "PBI_FormatHint": {
          "isGeneralNumber": true
        }
      }
    },
    {
      "source_name": "FISCAL_DATE",
      "datatype": "dateTime",
      "format_string": null,
      "lineage_tag": null,
      "source_column": "FISCAL_DATE",
      "description": null,
      "is_hidden": false,
      "summarize_by": "none",
      "data_category": null,
      "is_calculated": false,
      "is_data_type_inferred": false,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "FISCAL_MONTH",
      "datatype": "string",
      "format_string": null,
      "lineage_tag": null,
      "source_column": "FISCAL_MONTH",
      "description": null,
      "is_hidden": false,
      "summarize_by": "none",
      "data_category": null,
      "is_calculated": false,
      "is_data_type_inferred": false,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "FISCAL_QTR",
      "datatype": "string",
      "format_string": null,
      "lineage_tag": null,
      "source_column": "FISCAL_QTR",
      "description": null,
      "is_hidden": false,
      "summarize_by": "none",
      "data_category": null,
      "is_calculated": false,
      "is_data_type_inferred": false,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "FISCAL_YEAR",
      "datatype": "string",
      "format_string": null,
      "lineage_tag": null,
      "source_column": "FISCAL_YEAR",
      "description": null,
      "is_hidden": false,
      "summarize_by": "none",
      "data_category": null,
      "is_calculated": false,
      "is_data_type_inferred": false,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "FISCAL_WEEK",
      "datatype": "string",
      "format_string": null,
      "lineage_tag": null,
      "source_column": "FISCAL_WEEK",
      "description": null,
      "is_hidden": false,
      "summarize_by": "none",
      "data_category": null,
      "is_calculated": false,
      "is_data_type_inferred": false,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "FT",
      "datatype": "string",
      "format_string": null,
      "lineage_tag": null,
      "source_column": "FT",
      "description": null,
      "is_hidden": false,
      "summarize_by": "none",
      "data_category": null,
      "is_calculated": false,
      "is_data_type_inferred": false,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "OBJ_SMF_TABLES",
      "datatype": "string",
      "format_string": null,
      "lineage_tag": null,
      "source_column": "OBJ_SMF_TABLES",
      "description": null,
      "is_hidden": false,
      "summarize_by": "none",
      "data_category": null,
      "is_calculated": false,
      "is_data_type_inferred": false,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "AVG_DATA",
      "datatype": "string",
      "format_string": null,
      "lineage_tag": null,
      "source_column": "AVG_DATA",
      "description": null,
      "is_hidden": false,
      "summarize_by": "none",
      "data_category": null,
      "is_calculated": false,
      "is_data_type_inferred": false,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    }
  ],
  "measures": [
    {
      "source_name": "Weekly count",
      "dax_expression": "SUM(SWITCH(TRUE(), 'Custom SQL Query2'[weekday] = 6 || 'Custom SQL Query2'[weekday] = 7, 'Custom SQL Query2'[serial_count]))",
      "description": "Converted from Tableau calculation: { FIXED [FISCAL_WEEK]:SUM(IF [Calculation_1420604241832890368]=6 or [Calculation_1420604241832890368]=7 THEN [serial_count] END)}",
      "format_string": null,
      "is_hidden": false,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "Body",
      "dax_expression": "\"Date of Load \" & FORMAT(MIN([Week Start Date]), \"yyyy - MM - dd\") & \" System Count: \" & CONCATENATE(STR(SUM('Custom SQL Query2'[serial_count]))) & \" Golden Data Value: \" & CONCATENATE(STR(MAX('Custom SQL Query2'[Weekly count (copy)_1420604241838956546]))) & \" Regards, PUAT Data Load\"",
      "description": "Converted from Tableau calculation: \"Date of Load \"+STR(MIN([Calculation_1420604242555215877]))+\"\r\n\"+\r\n\"System Count: \"+STR(SUM(serial_count))+\"\r\n\r\n\"\r\n\r\n+\"Golden Data Value: \"+STR(MAX([Weekly count (copy)_1420604241838956546]))+\"\r\n\r\n\r\n\"+\r\n\"\r\nRegards,\r\nPUAT Data Load\"",
      "format_string": null,
      "is_hidden": false,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "1500 flag",
      "dax_expression": "SWITCH(TRUE(), MIN('Custom SQL Query2'[Max\\Avg]) - SUM('Custom SQL Query2'[serial_count]) > 1500, \"Flag\", \"Normal\")",
      "description": "Converted from Tableau calculation: IF MIN([Calculation_1857734887845101576])-SUM([serial_count])>1500 THEN 'Flag'\r\nELSE 'Normal'\r\nEND",
      "format_string": null,
      "is_hidden": false,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "Measure vs Golden",
      "dax_expression": "MIN('Custom SQL Query2'[Avg Range]) - SUM('Custom SQL Query2'[serial_count])",
      "description": "Converted from Tableau calculation: MIN([Calculation_1857734887806193665])-SUM([serial_count])",
      "format_string": null,
      "is_hidden": false,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "Diffrence",
      "dax_expression": "MIN([Max\\Avg]) - SUM('Custom SQL Query2'[serial_count])",
      "description": "Converted from Tableau calculation: MIN([Calculation_1857734887845101576])-SUM([serial_count])",
      "format_string": null,
      "is_hidden": false,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "Max\\Avg",
      "dax_expression": "SWITCH(TRUE(), 'Parameters'[Parameter 3] = \"Max\", 'Custom SQL Query2'[Weekly count (copy)_1420604241838956546], 'Parameters'[Parameter 3] = \"Avg\", [Avg Range])",
      "description": "Converted from Tableau calculation: IF [Parameters].[Parameter 3]='Max' THEN [Weekly count (copy)_1420604241838956546]\r\nELSEIF [Parameters].[Parameter 3]='Avg' THEN [Calculation_1857734887806193665] END",
      "format_string": null,
      "is_hidden": false,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "Diffrence flag",
      "dax_expression": "SWITCH(TRUE(), MIN('Custom SQL Query2'[Max\\Avg]) - SUM('Custom SQL Query2'[serial_count]) > 1500, \"Flag\", MIN('Custom SQL Query2'[Max\\Avg]) - SUM('Custom SQL Query2'[serial_count]) > = 0 && MIN('Custom SQL Query2'[Max\\Avg]) - SUM('Custom SQL Query2'[serial_count]) < = 1500, \"Normal\", MIN('Custom SQL Query2'[Max\\Avg]) - SUM('Custom SQL Query2'[serial_count]) < 0, \"Spike\")",
      "description": "Converted from Tableau calculation: IF  MIN([Calculation_1857734887845101576])-SUM([serial_count])>1500 THEN 'Flag'\r\nELSEIF MIN([Calculation_1857734887845101576])-SUM([serial_count])>=0 AND MIN([Calculation_1857734887845101576])-SUM([serial_count])<=1500 THEN 'Normal'\r\nELSEIF MIN([Calculation_1857734887845101576])-SUM([serial_count])<0 THEN 'Spike' END",
      "format_string": null,
      "is_hidden": false,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    },
    {
      "source_name": "Max Weekly count",
      "dax_expression": "MAX(FIXINGREDIENTS('Custom SQL Query2'[FISCAL_WEEK], SUM(SWITCH(TRUE(), ISOWEEKDAY('Custom SQL Query2'[FISCAL_DATE]) = 6 || ISOWEEKDAY('Custom SQL Query2'[FISCAL_DATE]) = 7, 'Custom SQL Query2'[serial_count]))))",
      "description": "Converted from Tableau calculation: {MAX({ FIXED [FISCAL_WEEK]:SUM(IF [Calculation_1420604241832890368]=6 or [Calculation_1420604241832890368]=7 THEN [serial_count] END)})}",
      "format_string": null,
      "is_hidden": false,
      "annotations": {
        "SummarizationSetBy": "Automatic"
      }
    }
  ],
  "hierarchies": [],
  "partitions": [
    {
      "name": "Custom SQL Query2",
      "source_type": "m",
      "expression": "\tlet Source = Dremio.Database([ ServerAddress = \"dlh - prd.corp.netapp.com:31011\", DatabaseName = \"DREMIO\", Authentication = \"auth - user - pass\", Username = \"hshaik@netapp.com\", CreateNavigationProperties = true ], [ HierarchicalNavigation = true, Query = \"SELECT * FROM dlh_nsec.objdb\" ]), #\"Navigation\" = Source{[Name = \"dlh_nsec.objdb\"]}[Data] in #\"Navigation\"",
      "description": "SQL partition for table Custom SQL Query2"
    }
  ],
  "has_widget_serialization": false,
  "visual_type": null,
  "column_settings": null
}