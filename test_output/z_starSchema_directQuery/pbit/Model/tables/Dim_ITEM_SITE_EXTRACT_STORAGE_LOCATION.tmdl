table Dim_ITEM_SITE_EXTRACT_STORAGE_LOCATION


    column 'SITE_NUMBER'
        dataType: string
        summarizeBy: none
        sourceColumn: SITE_NUMBER

        

        annotation SummarizationSetBy = Automatic

        
    column 'ITEM_NUMBER'
        dataType: string
        summarizeBy: none
        sourceColumn: ITEM_NUMBER

        

        annotation SummarizationSetBy = Automatic

        
    column 'ITEM_NUMBER_SITE_NUMBER_Key'
        dataType: string
        summarizeBy: none
        sourceColumn: ITEM_NUMBER_SITE_NUMBER_Key

        

        annotation SummarizationSetBy = Automatic

        



    partition 'Dim_ITEM_SITE_EXTRACT_STORAGE_LOCATION' = m
        mode: directQuery
        source = 
            let
                Source = Sql.Database(#"DB Server", #"DB Name"),
                Query = Value.NativeQuery(
                    Source,
                    "SELECT DISTINCT [SITE_NUMBER], [ITEM_NUMBER], ISNULL(CAST([SITE_NUMBER] AS NVARCHAR(50)), '') + '|' + ISNULL(CAST([ITEM_NUMBER] AS NVARCHAR(50)), '') as [ITEM_NUMBER_SITE_NUMBER_Key] FROM (SELECT [SITE_NUMBER], [ITEM_NUMBER] FROM [ITEM_SITE_EXTRACT] UNION ALL SELECT [SITE_NUMBER], [ITEM_NUMBER] FROM [STORAGE_LOCATION]) AS CombinedKeys WHERE ISNULL(CAST([SITE_NUMBER] AS NVARCHAR(50)), '') + '|' + ISNULL(CAST([ITEM_NUMBER] AS NVARCHAR(50)), '') IS NOT NULL AND ISNULL(CAST([SITE_NUMBER] AS NVARCHAR(50)), '') + '|' + ISNULL(CAST([ITEM_NUMBER] AS NVARCHAR(50)), '') <> ''''''",
                    null, 
                    [EnableFolding = true]
                )
                in
                Query
        



    annotation PBI_ResultType = Table