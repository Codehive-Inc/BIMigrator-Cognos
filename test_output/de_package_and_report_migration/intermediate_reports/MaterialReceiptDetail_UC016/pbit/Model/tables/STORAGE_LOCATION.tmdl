table STORAGE_LOCATION


    column 'DATE_ENTERED'
        dataType: string
        summarizeBy: none
        sourceColumn: DATE_ENTERED

        

        annotation SummarizationSetBy = Automatic

        
    column 'SITE_NUMBER'
        dataType: string
        summarizeBy: none
        sourceColumn: SITE_NUMBER

        

        annotation SummarizationSetBy = Automatic

        
    column 'PO_NUMBER'
        dataType: string
        summarizeBy: none
        sourceColumn: PO_NUMBER

        

        annotation SummarizationSetBy = Automatic

        
    column 'PO_LINE_NUMBER'
        dataType: string
        summarizeBy: none
        sourceColumn: PO_LINE_NUMBER

        

        annotation SummarizationSetBy = Automatic

        
    column 'RELEASE_NUMBER'
        dataType: string
        summarizeBy: none
        sourceColumn: RELEASE_NUMBER

        

        annotation SummarizationSetBy = Automatic

        
    column 'DATE_RECEIVED_AT_SITE'
        dataType: string
        summarizeBy: none
        sourceColumn: DATE_RECEIVED_AT_SITE

        

        annotation SummarizationSetBy = Automatic

        
    column 'QTY_RECEIVED'
        dataType: string
        summarizeBy: none
        sourceColumn: QTY_RECEIVED

        

        annotation SummarizationSetBy = Automatic

        
    column 'TIME_ENTERED'
        dataType: string
        summarizeBy: none
        sourceColumn: TIME_ENTERED

        

        annotation SummarizationSetBy = Automatic

        
    column 'ITEM_NUMBER'
        dataType: string
        summarizeBy: none
        sourceColumn: ITEM_NUMBER

        

        annotation SummarizationSetBy = Automatic

        
    column 'JOB_NUMBER'
        dataType: string
        summarizeBy: none
        sourceColumn: JOB_NUMBER

        

        annotation SummarizationSetBy = Automatic

        
    column 'UNIT_OF_MEASURE'
        dataType: string
        summarizeBy: none
        sourceColumn: UNIT_OF_MEASURE

        

        annotation SummarizationSetBy = Automatic

        
    column 'REQUESTOR_NAME'
        dataType: string
        summarizeBy: none
        sourceColumn: REQUESTOR_NAME

        

        annotation SummarizationSetBy = Automatic

        
    column 'VENDOR_NAME'
        dataType: string
        summarizeBy: none
        sourceColumn: VENDOR_NAME

        

        annotation SummarizationSetBy = Automatic

        
    column 'LOCATION1'
        dataType: string
        summarizeBy: none
        sourceColumn: LOCATION1

        

        annotation SummarizationSetBy = Automatic

        
    column 'LOCATION2'
        dataType: string
        summarizeBy: none
        sourceColumn: LOCATION2

        

        annotation SummarizationSetBy = Automatic

        
    column 'UNIT_PRICE'
        dataType: string
        summarizeBy: none
        sourceColumn: UNIT_PRICE

        

        annotation SummarizationSetBy = Automatic

        
    column 'DESCRIPTION1'
        dataType: string
        summarizeBy: none
        sourceColumn: DESCRIPTION1

        

        annotation SummarizationSetBy = Automatic

        
    column 'LOC1' = ```
            LEFT(RIGHT(REPT(" ", 12) & 'STORAGE_LOCATION'[LOCATION1], 12), 2) & " " & MID(REPT(" ", 12) & 'STORAGE_LOCATION'[LOCATION1], 3, 2) & " " & MID(REPT(" ", 12) & 'STORAGE_LOCATION'[LOCATION1], 5, 2) & " " & MID(REPT(" ", 12) & 'STORAGE_LOCATION'[LOCATION1], 7, 2) & " " & MID(REPT(" ", 12) & 'STORAGE_LOCATION'[LOCATION1], 9, 2) & " " & MID(REPT(" ", 12) & 'STORAGE_LOCATION'[LOCATION1], 11, 2)
    ```
        dataType: string
        summarizeBy: none

        

        annotation SummarizationSetBy = Automatic

        
    column 'LOC2' = ```
            LEFT(RIGHT(REPT(" ", 12) & 'STORAGE_LOCATION'[LOCATION2], 12), 2) & " " & MID(REPT(" ", 12) & 'STORAGE_LOCATION'[LOCATION2], 3, 2) & " " & MID(REPT(" ", 12) & 'STORAGE_LOCATION'[LOCATION2], 5, 2) & " " & MID(REPT(" ", 12) & 'STORAGE_LOCATION'[LOCATION2], 7, 2) & " " & MID(REPT(" ", 12) & 'STORAGE_LOCATION'[LOCATION2], 9, 2) & " " & MID(REPT(" ", 12) & 'STORAGE_LOCATION'[LOCATION2], 11, 2)
    ```
        dataType: string
        summarizeBy: none

        

        annotation SummarizationSetBy = Automatic

        
    column 'TotalCost' = ```
            TotalCost
    ```
        dataType: decimal
        summarizeBy: sum

        

        annotation SummarizationSetBy = User

        



    partition 'STORAGE_LOCATION' = m
        mode: import
        source = 
            	let
					Source = Sql.Database("your_server", "your_database"),
					SQL = Value.NativeQuery(Source, "SELECT
    ""PURCHASE_ORDER_RECEIPT"".""DATE_ENTERED"" AS ""DATE_ENTERED"",
    ""PURCHASE_ORDER_RECEIPT"".""SITE_NUMBER"" AS ""SITE_NUMBER"",
    ""PURCHASE_ORDER_RECEIPT"".""PO_NUMBER"" AS ""PO_NUMBER"",
    ""PURCHASE_ORDER_RECEIPT"".""PO_LINE_NUMBER"" AS ""PO_LINE_NUMBER"",
    ""PURCHASE_ORDER_RECEIPT"".""RELEASE_NUMBER"" AS ""RELEASE_NUMBER"",
    ""PURCHASE_ORDER_RECEIPT"".""DATE_RECEIVED_AT_SITE"" AS ""DATE_RECEIVED_AT_SITE"",
    ""PURCHASE_ORDER_RECEIPT"".""QTY_RECEIVED"" AS ""QTY_RECEIVED"",
    ""PURCHASE_ORDER_RECEIPT"".""TIME_ENTERED"" AS ""TIME_ENTERED"",
    ""PURCHASE_ORDER_LINE"".""ITEM_NUMBER"" AS ""ITEM_NUMBER"",
    ""PURCHASE_ORDER_LINE"".""JOB_NUMBER"" AS ""JOB_NUMBER"",
    ""PURCHASE_ORDER_LINE"".""UNIT_OF_MEASURE"" AS ""UNIT_OF_MEASURE"",
    ""PURCHASE_ORDER_LINE"".""REQUESTOR_NAME"" AS ""REQUESTOR_NAME"",
    ""PURCHASE_ORDER_LINE"".""VENDOR_NAME"" AS ""VENDOR_NAME"",
    ""STORAGE_LOCATION"".""LOCATION1"" AS ""LOCATION1"",
    ""STORAGE_LOCATION"".""LOCATION2"" AS ""LOCATION2"",
    ""PURCHASE_ORDER_RECEIPT"".""UNIT_PRICE"" AS ""UNIT_PRICE"",
    ""PURCHASE_ORDER_DESCRIPTIONS"".""DESCRIPTION1"" AS ""DESCRIPTION1"",
    substring(rpad([LOCATION1], 12, ' '), 1,2) + ' ' +
substring(rpad([LOCATION1], 12, ' '), 3,2) + ' ' +
substring(rpad([LOCATION1], 12, ' '), 5,2) + ' ' +
substring(rpad([LOCATION1], 12, ' '), 7,2) + ' ' +
substring(rpad([LOCATION1], 12, ' '), 9,2) + ' ' +
substring(rpad([LOCATION1], 12, ' '), 11,2) AS ""LOC1"",
    substring(rpad([LOCATION2], 12, ' '), 1,2) + ' ' +
substring(rpad([LOCATION2], 12, ' '), 3,2) + ' ' +
substring(rpad([LOCATION2], 12, ' '), 5,2) + ' ' +
substring(rpad([LOCATION2], 12, ' '), 7,2) + ' ' +
substring(rpad([LOCATION2], 12, ' '), 9,2) + ' ' +
substring(rpad([LOCATION2], 12, ' '), 11,2) AS ""LOC2"",
    [UNIT_PRICE] * [QTY_RECEIVED] AS ""TotalCost""
FROM
""Database_Layer"".""PURCHASE_ORDER_DESCRIPTIONS"", ""Database_Layer"".""PURCHASE_ORDER_LINE"", ""Database_Layer"".""PURCHASE_ORDER_RECEIPT"", ""Database_Layer"".""STORAGE_LOCATION""
WHERE
    [SITE_NUMBER]= ?SiteNumber?
    AND     [PO_NUMBER]= ?PONumber?
    AND     [PO_LINE_NUMBER]=?LineNumber?
    AND     [RELEASE_NUMBER]=?ReleaseNumber?
    AND     [DATE_ENTERED]=?DateEntered?
    AND     [TIME_ENTERED]=?TimeEntered?", null, [EnableFolding=true])
				in
					SQL
        



    annotation PBI_ResultType = Table