{
  "name": "Dim_PURCHASE_ORDER_LINE_PURCHASE_ORDER_RECEIPT",
  "columns": [
    {
      "name": "PO_NUMBER",
      "dataType": "string",
      "sourceColumn": "PO_NUMBER",
      "summarizeBy": "none",
      "isKey": false,
      "isNullable": true
    },
    {
      "name": "RELEASE_NUMBER",
      "dataType": "string",
      "sourceColumn": "RELEASE_NUMBER",
      "summarizeBy": "none",
      "isKey": false,
      "isNullable": true
    },
    {
      "name": "PO_LINE_NUMBER",
      "dataType": "string",
      "sourceColumn": "PO_LINE_NUMBER",
      "summarizeBy": "none",
      "isKey": false,
      "isNullable": true
    },
    {
      "name": "SITE_NUMBER",
      "dataType": "string",
      "sourceColumn": "SITE_NUMBER",
      "summarizeBy": "none",
      "isKey": false,
      "isNullable": true
    },
    {
      "name": "PO_LINE_NUMBER_PO_NUMBER_RELEASE_NUMBER_SITE_NUMBER_Key",
      "dataType": "string",
      "sourceColumn": "PO_LINE_NUMBER_PO_NUMBER_RELEASE_NUMBER_SITE_NUMBER_Key",
      "summarizeBy": "none",
      "isKey": true,
      "isNullable": true
    }
  ],
  "partitions": [
    {
      "name": "Dim_PURCHASE_ORDER_LINE_PURCHASE_ORDER_RECEIPT",
      "source_type": "m",
      "mode": "import",
      "expression": "let\n                // Get data from PURCHASE_ORDER_LINE\n                Data_From_PURCHASE_ORDER_LINE = Table.SelectColumns(PURCHASE_ORDER_LINE, {\"PO_NUMBER\", \"RELEASE_NUMBER\", \"PO_LINE_NUMBER\", \"SITE_NUMBER\"}),\n                // Get data from PURCHASE_ORDER_RECEIPT\n                Data_From_PURCHASE_ORDER_RECEIPT = Table.SelectColumns(PURCHASE_ORDER_RECEIPT, {\"PO_NUMBER\", \"RELEASE_NUMBER\", \"PO_LINE_NUMBER\", \"SITE_NUMBER\"}),\n                // Combine data from all source tables\n                CombinedData = Table.Combine({Data_From_PURCHASE_ORDER_LINE, Data_From_PURCHASE_ORDER_RECEIPT}),\n                // Get unique combinations of dimension keys\n                UniqueRows = Table.Distinct(CombinedData, {\"PO_NUMBER\", \"RELEASE_NUMBER\", \"PO_LINE_NUMBER\", \"SITE_NUMBER\"}),\n                // Create composite key for relationships\n                AddCompositeKey = Table.AddColumn(UniqueRows, \"PO_LINE_NUMBER_PO_NUMBER_RELEASE_NUMBER_SITE_NUMBER_Key\", each Text.Combine({[PO_LINE_NUMBER], [PO_NUMBER], [RELEASE_NUMBER], [SITE_NUMBER]}, \"|\"), type text),\n                // Filter out rows with null or empty composite keys\n                FilteredRows = Table.SelectRows(AddCompositeKey, each [PO_LINE_NUMBER_PO_NUMBER_RELEASE_NUMBER_SITE_NUMBER_Key] <> null and [PO_LINE_NUMBER_PO_NUMBER_RELEASE_NUMBER_SITE_NUMBER_Key] <> \"\")\n            in\n                FilteredRows"
    }
  ],
  "has_widget_serialization": false,
  "visual_type": null,
  "column_settings": null
}