table MATERIAL_CHARGES


    column 'SITE_NUMBER'
        dataType: string
        summarizeBy: none
        sourceColumn: SITE_NUMBER

        

        annotation SummarizationSetBy = Automatic

        
    column 'ITEM_NUMBER'
        dataType: string
        summarizeBy: none
        sourceColumn: ITEM_NUMBER

        

        annotation SummarizationSetBy = Automatic

        
    column 'CHARGED_DATE'
        dataType: dateTime
        summarizeBy: none
        sourceColumn: CHARGED_DATE

        

        annotation SummarizationSetBy = Automatic

        
    column 'TIME_ENTERED'
        dataType: string
        summarizeBy: none
        sourceColumn: TIME_ENTERED

        

        annotation SummarizationSetBy = Automatic

        
    column 'STOREKEEPER_ID'
        dataType: string
        summarizeBy: none
        sourceColumn: STOREKEEPER_ID

        

        annotation SummarizationSetBy = Automatic

        
    column 'EMPLOYEE_ID'
        dataType: string
        summarizeBy: none
        sourceColumn: EMPLOYEE_ID

        

        annotation SummarizationSetBy = Automatic

        
    column 'ISSUE_TICKET_NUMBER'
        dataType: string
        summarizeBy: none
        sourceColumn: ISSUE_TICKET_NUMBER

        

        annotation SummarizationSetBy = Automatic

        
    column 'TRANSACTION_TYPE'
        dataType: string
        summarizeBy: none
        sourceColumn: TRANSACTION_TYPE

        

        annotation SummarizationSetBy = Automatic

        
    column 'ADJUSTMENT_TYPE'
        dataType: string
        summarizeBy: none
        sourceColumn: ADJUSTMENT_TYPE

        

        annotation SummarizationSetBy = Automatic

        
    column 'QUANTITY'
        dataType: int64
        summarizeBy: none
        sourceColumn: QUANTITY

        

        annotation SummarizationSetBy = Automatic

        
    column 'UNIT_PRICE'
        dataType: int64
        summarizeBy: none
        sourceColumn: UNIT_PRICE

        

        annotation SummarizationSetBy = Automatic

        
    column 'TRANSACTION_VALUE'
        dataType: int64
        summarizeBy: none
        sourceColumn: TRANSACTION_VALUE

        

        annotation SummarizationSetBy = Automatic

        
    column 'JOB_NUMBER'
        dataType: string
        summarizeBy: none
        sourceColumn: JOB_NUMBER

        

        annotation SummarizationSetBy = Automatic

        
    column 'BU_NUMBER'
        dataType: string
        summarizeBy: none
        sourceColumn: BU_NUMBER

        

        annotation SummarizationSetBy = Automatic

        
    column 'PO_NUMBER'
        dataType: string
        summarizeBy: none
        sourceColumn: PO_NUMBER

        

        annotation SummarizationSetBy = Automatic

        
    column 'PO_INDICATOR'
        dataType: string
        summarizeBy: none
        sourceColumn: PO_INDICATOR

        

        annotation SummarizationSetBy = Automatic

        
    column 'DATE_ENTERED'
        dataType: dateTime
        summarizeBy: none
        sourceColumn: DATE_ENTERED

        

        annotation SummarizationSetBy = Automatic

        
    column 'DATE_STATUS_EFFECTIVE'
        dataType: dateTime
        summarizeBy: none
        sourceColumn: DATE_STATUS_EFFECTIVE

        

        annotation SummarizationSetBy = Automatic

        
    column 'REFURB_IND'
        dataType: string
        summarizeBy: none
        sourceColumn: REFURB_IND

        

        annotation SummarizationSetBy = Automatic

        
    column 'ISSUE_OVERRIDE_IND'
        dataType: string
        summarizeBy: none
        sourceColumn: ISSUE_OVERRIDE_IND

        

        annotation SummarizationSetBy = Automatic

        
    column 'RECORD_STATUS'
        dataType: string
        summarizeBy: none
        sourceColumn: RECORD_STATUS

        

        annotation SummarizationSetBy = Automatic

        
    column 'UNIT_OF_MEASURE'
        dataType: string
        summarizeBy: none
        sourceColumn: UNIT_OF_MEASURE

        

        annotation SummarizationSetBy = Automatic

        
    column 'ADJUSTMENT_NUMBER'
        dataType: string
        summarizeBy: none
        sourceColumn: ADJUSTMENT_NUMBER

        

        annotation SummarizationSetBy = Automatic

        
    column 'ADJUSTMENT_DESC'
        dataType: string
        summarizeBy: none
        sourceColumn: ADJUSTMENT_DESC

        

        annotation SummarizationSetBy = Automatic

        
    column 'QTY_TO_RECONCILE'
        dataType: int64
        summarizeBy: none
        sourceColumn: QTY_TO_RECONCILE

        

        annotation SummarizationSetBy = Automatic

        
    column 'STOP'
        dataType: string
        summarizeBy: none
        sourceColumn: STOP

        

        annotation SummarizationSetBy = Automatic

        
    column 'TRANSFER_NUMBER'
        dataType: string
        summarizeBy: none
        sourceColumn: TRANSFER_NUMBER

        

        annotation SummarizationSetBy = Automatic

        
    column 'MATERIAL_CLASS'
        dataType: string
        summarizeBy: none
        sourceColumn: MATERIAL_CLASS

        

        annotation SummarizationSetBy = Automatic

        
    column 'ROOT_DESCRIPTION'
        dataType: string
        summarizeBy: none
        sourceColumn: ROOT_DESCRIPTION

        

        annotation SummarizationSetBy = Automatic

        
    column 'ITT_KEY_NO'
        dataType: string
        summarizeBy: none
        sourceColumn: ITT_KEY_NO

        

        annotation SummarizationSetBy = Automatic

        
    column 'UTC_NO'
        dataType: string
        summarizeBy: none
        sourceColumn: UTC_NO

        

        annotation SummarizationSetBy = Automatic

        
    column 'PIT_IND'
        dataType: string
        summarizeBy: none
        sourceColumn: PIT_IND

        

        annotation SummarizationSetBy = Automatic

        
    column 'UM'
        dataType: string
        summarizeBy: none
        sourceColumn: UM

        

        annotation SummarizationSetBy = Automatic

        

    measure 'MATERIAL_CHARGES - Count by CHARGED_DATE' = ```
            CALCULATE(
    COUNTROWS('MATERIAL_CHARGES'),
    USERELATIONSHIP('CentralDateTable'[Date], 'MATERIAL_CHARGES'[CHARGED_DATE])
)
    ```


        annotation PBI_FormatHint = {"isGeneralNumber":true}
        
    measure 'MATERIAL_CHARGES - Count by DATE_ENTERED' = ```
            CALCULATE(
    COUNTROWS('MATERIAL_CHARGES'),
    USERELATIONSHIP('CentralDateTable'[Date], 'MATERIAL_CHARGES'[DATE_ENTERED])
)
    ```


        annotation PBI_FormatHint = {"isGeneralNumber":true}
        
    measure 'MATERIAL_CHARGES - Count by DATE_STATUS_EFFECTIVE' = ```
            CALCULATE(
    COUNTROWS('MATERIAL_CHARGES'),
    USERELATIONSHIP('CentralDateTable'[Date], 'MATERIAL_CHARGES'[DATE_STATUS_EFFECTIVE])
)
    ```


        annotation PBI_FormatHint = {"isGeneralNumber":true}
        


    partition 'MATERIAL_CHARGES' = m
        mode: import
        source = 
            let
    // --- 1. DEFINE THE SQL QUERY ---
    SQL_Statement = "SELECT * FROM MATERIAL_CHARGES",

    // --- 2. CONNECT TO THE DATABASE ---
    Source = Sql.Database(#"DB Server", #"DB Name"),

    // --- 3. EXECUTE THE NATIVE SQL QUERY ---
    ExecuteQuery = Value.NativeQuery(
        Source,
        SQL_Statement,
        null,
        [EnableFolding=true]
    ),

    // --- 4. VALIDATE THAT DATA WAS RETURNED ---
    ValidateResults = if Table.IsEmpty(ExecuteQuery) then
                        error "No data was returned from the SQL query for the MATERIAL_CHARGES table."
                      else
                        ExecuteQuery
in
    ValidateResults
        



    annotation PBI_ResultType = Table