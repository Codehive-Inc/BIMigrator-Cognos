table WO_MATERIALS


    column 'SITE'
        dataType: string
        summarizeBy: none
        sourceColumn: SITE

        

        annotation SummarizationSetBy = Automatic

        
    column 'WORKORDER'
        dataType: string
        summarizeBy: none
        sourceColumn: WORKORDER

        

        annotation SummarizationSetBy = Automatic

        
    column 'REC_TYP'
        dataType: string
        summarizeBy: none
        sourceColumn: REC_TYP

        

        annotation SummarizationSetBy = Automatic

        
    column 'ITEM_NUM'
        dataType: string
        summarizeBy: none
        sourceColumn: ITEM_NUM

        

        annotation SummarizationSetBy = Automatic

        
    column 'PO_NUM'
        dataType: string
        summarizeBy: none
        sourceColumn: PO_NUM

        

        annotation SummarizationSetBy = Automatic

        
    column 'SERIAL_NUM'
        dataType: string
        summarizeBy: none
        sourceColumn: SERIAL_NUM

        

        annotation SummarizationSetBy = Automatic

        
    column 'MODEL_NUM'
        dataType: string
        summarizeBy: none
        sourceColumn: MODEL_NUM

        

        annotation SummarizationSetBy = Automatic

        
    column 'UNIT_MEAS'
        dataType: string
        summarizeBy: none
        sourceColumn: UNIT_MEAS

        

        annotation SummarizationSetBy = Automatic

        
    column 'QTY'
        dataType: string
        summarizeBy: none
        sourceColumn: QTY

        

        annotation SummarizationSetBy = Automatic

        
    column 'DESCRIPTION'
        dataType: string
        summarizeBy: none
        sourceColumn: DESCRIPTION

        

        annotation SummarizationSetBy = Automatic

        
    column 'MODEL_TYPE'
        dataType: string
        summarizeBy: none
        sourceColumn: MODEL_TYPE

        

        annotation SummarizationSetBy = Automatic

        
    column 'MARK_NUMBER'
        dataType: string
        summarizeBy: none
        sourceColumn: MARK_NUMBER

        

        annotation SummarizationSetBy = Automatic

        



    partition 'WO_MATERIALS' = m
        mode: import
        source = 
            let
    // --- 1. DEFINE THE SQL QUERY ---
    SQL_Statement = "SELECT * FROM WO_MATERIALS",

    // --- 2. CONNECT TO THE DATABASE ---
    Source = Sql.Database(#"DB Server", #"DB Name"),

    // --- 3. EXECUTE THE NATIVE SQL QUERY ---
    ExecuteQuery = Value.NativeQuery(
        Source,
        SQL_Statement,
        null,
        [EnableFolding=true]
    ),

    // --- 4. VALIDATE THAT DATA WAS RETURNED ---
    ValidateResults = if Table.IsEmpty(ExecuteQuery) then
                        error "No data was returned from the SQL query for the WO_MATERIALS table."
                      else
                        ExecuteQuery
in
    ValidateResults
        



    annotation PBI_ResultType = Table